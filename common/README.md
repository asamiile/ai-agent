# `common/`

## 概要
このディレクトリは、様々なエージェントが共通して利用する汎用的なユーティリティモジュールや、特定のWebサイトからデータを収集するためのスクレイピングモジュールを格納します。コードの再利用性を高め、各エージェントのロジックから基盤となる処理を分離することを目的としています。

## ディレクトリ構成


common/
├── discord.py
└── scrapers/
    ├── yahoo.py
    ├── zozo.py
    └── __init__.py


## 各ファイル/モジュールの説明

| ファイル/モジュール名 | 説明                                                                                                                                              |
| :-------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------ |
| `discord.py`          | DiscordのWebhookを介して通知を送信する機能を提供します。商品のURLリストを受け取り、整形されたメッセージとしてDiscordチャンネルに投稿します。               |
| `scrapers/`           | 各ECサイトやWebサイトから商品情報やリンクをスクレイピングするためのモジュール群を格納するサブディレクトリです。                                       |
| `scrapers/yahoo.py`   | Playwrightを使用してYahoo!ショッピングの検索結果ページから商品詳細ページのURLを収集する機能を提供します。ページネーションを考慮し、複数ページからのリンク収集が可能です。 |
| `scrapers/zozo.py`    | PlaywrightとBeautifulSoupを使用してZOZOTOWNのブランドページから商品詳細ページのURLを収集する機能を提供します。自動化検知回避の試みが含まれていますが、現状アクセスが困難である旨がコメントで示されています。 |

## 実行方法

このディレクトリ内のモジュールは、主に他のエージェントからインポートされて使用されることを想定していますが、スクレイピングモジュールは単独で実行して動作を確認することも可能です。

### Yahoo!ショッピングのスクレイピングを実行する

Yahoo!ショッピングから「DIESEL KIDS アウトレット」の商品リンクを収集するデモンストレーションを実行します。

bash
python common/scrapers/yahoo.py


### ZOZOTOWNのスクレイピングを実行する

ZOZOTOWNの「DIESEL KIDS」ブランドページから商品リンクを収集するデモンストレーションを実行します。
**注意:** 現在、ZOZOTOWNは自動化検知が強化されており、スクレイピングが成功しない可能性があります。

bash
python common/scrapers/zozo.py


## 環境変数

`common/discord.py`は直接環境変数を読み込みませんが、`send_discord_notification`関数を利用する際にはDiscord WebhookのURLが必要です。このURLは通常、以下のような環境変数を通じて提供されます。

| 環境変数名           | 説明                                              | 例                                  |
| :------------------- | :------------------------------------------------ | :---------------------------------- |
| `DISCORD_WEBHOOK_URL` | Discord通知を送信するためのWebhookのURL。         | `https://discord.com/api/webhooks/...` |

他のスクレイピングモジュールは直接環境変数を使用しません。