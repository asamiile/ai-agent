# common/

## 概要
`common/` ディレクトリは、プロジェクト全体で再利用される共通のユーティリティ関数やモジュールを格納する場所です。Discord通知機能、Webスクレイピングのロジック（Yahoo!ショッピング、ZOZOTOWN）、および関連するサブパッケージが含まれており、各エージェントが特定のタスクを効率的に実行するために利用します。

## ディレクトリ構成


common/
├── discord.py
├── scrapers/
│   ├── __init__.py
│   ├── yahoo.py
│   └── zozo.py
└── __init__.py


## 各ファイル/モジュールの説明

| ファイル/モジュール           | 目的・機能                                                                                                                                                                                                                                                                                                  |
| :-------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `__init__.py`               | Pythonパッケージとして `common` ディレクトリを認識させるためのファイルです。                                                                                                                                                                                                                                |
| `discord.py`                | Discordのウェブフックを利用して、指定されたアイテムのURLリストを通知メッセージとして送信する機能を提供します。商品URLのリストを受け取り、フォーマットされたメッセージを作成してDiscordチャンネルに送信します。`agents/fashion_diesel_kids/main.py` などで利用されます。                                         |
| `scrapers/`                 | 各ECサイトからの情報収集（スクレイピング）に関連するモジュールをまとめたサブパッケージです。                                                                                                                                                                                                                |
| `scrapers/__init__.py`      | `scrapers` サブディレクトリをPythonパッケージとして認識させるためのファイルです。                                                                                                                                                                                                                           |
| `scrapers/yahoo.py`         | [Playwright](https://playwright.dev/python/docs/api/class-playwright) を使用してYahoo!ショッピングの検索結果ページから商品リンクを収集します。指定された検索結果URLにアクセスし、特定のCSSセレクタに基づいてページ内の全商品リンクを抽出します。複数ページにわたるリンク収集に対応しています。`agents/fashion_diesel_kids/main.py` で利用されます。 |
| `scrapers/zozo.py`          | PlaywrightとBeautifulSoupを使用してZOZOTOWNから商品リンクを収集します。Playwrightの `page.add_init_script()` を用いて `navigator.webdriver` プロパティを無効化し、自動化検知を回避しようと試みます。取得したHTMLをBeautifulSoupで解析し、商品リンクを抽出します。 (※ 現状、ZOZOTOWNへのアクセスは困難であることがコード内で示唆されています。) |

## 実行方法 (該当する場合)

このディレクトリ内のファイルは、主に他のスクリプトやエージェントからインポートされて使用される共通ユーティリティモジュールです。そのため、直接実行される `main.py` のようなファイルは存在しません。

ただし、`common/scrapers/yahoo.py` と `common/scrapers/zozo.py` には `if __name__ == "__main__":` ブロックが含まれており、それぞれ単体で実行して動作を確認することが可能です。

### Yahoo!ショッピングスクレイパーの単体実行例

このコマンドは、「ディーゼルキッズ アウトレット」の検索結果を複数ページにわたってスクレイピングし、収集した商品リンクをコンソールに出力します。

bash
python common/scrapers/yahoo.py


### ZOZOTOWNスクレイパーの単体実行例

このコマンドは、「DIESEL KIDS」ブランドページから商品リンクを収集しようと試みます。

bash
python common/scrapers/zozo.py


## 環境変数 (該当する場合)

`common/discord.py` モジュール自体は直接環境変数を読み込みませんが、このモジュールを呼び出す側のスクリプト（例: `agents/fashion_diesel_kids/main.py`）は、Discord通知のために以下の環境変数を必要とします。

*   `DISCORD_WEBHOOK_URL`: Discordへの通知に使用するウェブフックのURL。