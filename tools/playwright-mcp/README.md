# Playwright を活用した Web アプリ探索テスト

## 概要

Playwright MCP (Model Context Protocol) を使用して、AI エージェントが Web アプリケーションを探索的にテストする手順をまとめたドキュメントです。

## 前提条件

- VS Code with GitHub Copilot
- Playwright MCP Server が有効化されていること

## 探索テストの手順

### 1. ブラウザでサイトにアクセス

```
Playwrightツールを使って、[対象URL]にアクセスしてください。
```

AI エージェントは `browser_navigate` ツールを使用してサイトにアクセスします。

### 2. ページ構造の確認

アクセス後、自動的にページのスナップショットが取得され、以下の情報が確認できます：

- ページ URL
- ページタイトル
- DOM 構造（アクセシブルな要素のツリー）
- ナビゲーション要素
- リンク、ボタン、フォーム要素

### 3. ナビゲーションテスト

各ページへのリンクをクリックして遷移をテストします：

```
各ナビゲーションリンクをクリックして、ページ遷移をテストしてください。
```

**確認項目：**
- リンクが正常に動作するか
- 遷移先のページが正しく表示されるか
- ページタイトルが適切か

### 4. フォームテスト

フォームがある場合は入力テストを実施：

```
フォームに値を入力して、動作を確認してください。
```

**確認項目：**
- テキスト入力が正常にできるか
- ドロップダウン選択が動作するか
- バリデーションが機能するか
- 送信ボタンが動作するか

### 5. インタラクティブ要素のテスト

カルーセル、タブ、モーダルなどの動的要素をテスト：

```
ページ内のインタラクティブな要素（カルーセル、タブなど）をテストしてください。
```

### 6. レスポンシブデザインテスト

画面サイズを変更してレスポンシブ対応を確認：

```
モバイルサイズ（375x812）でレスポンシブデザインをテストしてください。
```

**一般的なビューポートサイズ：**
| デバイス | 幅 | 高さ |
|----------|-----|------|
| iPhone SE | 375 | 667 |
| iPhone 12/13 | 390 | 844 |
| iPad | 768 | 1024 |
| Desktop | 1280 | 720 |

### 7. コンソールエラーの確認

JavaScript エラーがないか確認：

```
コンソールにエラーが出ていないか確認してください。
```

### 8. スクリーンショットの取得

ビジュアル確認用にスクリーンショットを撮影：

```
現在のページのスクリーンショットを撮影してください。
```

## 使用可能な Playwright MCP ツール

| ツール | 説明 |
|--------|------|
| `browser_navigate` | URL に遷移 |
| `browser_snapshot` | ページのアクセシビリティスナップショット取得 |
| `browser_click` | 要素をクリック |
| `browser_type` | テキストを入力 |
| `browser_select_option` | ドロップダウンで選択 |
| `browser_hover` | 要素にホバー |
| `browser_press_key` | キーを押下 |
| `browser_resize` | ウィンドウサイズ変更 |
| `browser_take_screenshot` | スクリーンショット撮影 |
| `browser_console_messages` | コンソールメッセージ取得 |
| `browser_navigate_back` | 前のページに戻る |
| `browser_close` | ブラウザを閉じる |

## プロンプト例

### 基本的な探索テスト

```
Playwrightツールを使って、https://example.com/にアクセスしてください。
Webアプリの挙動を探索的にテストしてください。
```

### 特定ページのテスト

```
Playwrightを使って以下をテストしてください：
1. https://example.com/contact にアクセス
2. フォームに適当な値を入力
3. 送信ボタンの動作を確認
4. バリデーションエラーの表示を確認
```

### レスポンシブテスト

```
Playwrightで https://example.com/ のレスポンシブデザインをテストしてください。
- デスクトップ（1280x720）
- タブレット（768x1024）
- モバイル（375x812）
各サイズでスクリーンショットを撮影してください。
```

### パフォーマンス観点のテスト

```
Playwrightで https://example.com/ にアクセスし、以下を確認してください：
- ページの読み込み完了
- 画像の遅延読み込み動作
- コンソールエラーの有無
```

## テスト結果のレポート形式

探索テストの結果は以下の形式でまとめることを推奨：

```markdown
## 探索テスト結果

### テスト対象
- URL: https://example.com/
- テスト日: YYYY-MM-DD

### テストしたページ
| ページ | URL | 結果 |
|--------|-----|------|
| トップ | / | ✅ 正常 |
| 詳細 | /detail | ✅ 正常 |

### 確認した機能
- [ ] ナビゲーション
- [ ] フォーム入力
- [ ] レスポンシブデザイン
- [ ] 外部リンク

### 発見した問題
1. 問題の説明
   - 再現手順
   - 期待される動作
   - 実際の動作

### スクリーンショット
- デスクトップ: screenshot_desktop.png
- モバイル: screenshot_mobile.png
```

## 注意事項

1. **本番環境での注意**: フォーム送信テストは実際にデータを送信する可能性があるため、テスト環境で実施することを推奨

2. **認証が必要なページ**: ログインが必要なページはセッション管理に注意

3. **動的コンテンツ**: JavaScript で動的に生成されるコンテンツは、適切な待機時間を考慮

4. **外部サービス**: 埋め込みコンテンツ（YouTube、Vimeo など）は外部サービスに依存

## 関連リンク

- [Playwright 公式ドキュメント](https://playwright.dev/)
- [Playwright MCP Server](https://github.com/microsoft/playwright-mcp)
